[request_definition]
# sub = 请求者（用户或角色）
# obj = 资源（文件、目录、API等）
# act = 操作类型（read, write, delete ,owen 等）
r = sub, obj, act

[policy_definition]
# p.sub = 拥有权限的用户或角色
# p.obj = 资源
# p.act = 操作类型
p = sub, obj, act

[role_definition]
# 定义用户与角色关系
g = _, _

[policy_effect]
# 只要有一个策略允许，就通过
e = some(where (p.eft == allow))

[matchers]
# 匹配逻辑：
# 1. 用户与角色匹配 (g)
# 2. 资源支持通配符匹配 (file:*)
# 3. 行为匹配
# 4. 若资源有所有者，则拥有 owner 权限（可选扩展）
m = g(r.sub, p.sub) && keyMatch(r.obj, p.obj) && r.act == p.act
